!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("fs"),require("tslib"),require("@angular/compiler"),require("@angular/core"),require("@angular/platform-server")):"function"==typeof define&&define.amd?define("@nguniversal/common/engine",["exports","fs","tslib","@angular/compiler","@angular/core","@angular/platform-server"],r):r(((e=e||self).nguniversal=e.nguniversal||{},e.nguniversal.common=e.nguniversal.common||{},e.nguniversal.common.engine={}),e.fs,e.tslib,e.ng.compiler,e.ng.core,e.ng.platformServer)}(this,function(e,r,t,n,o,i){"use strict";
/**
     * @license
     * Copyright Google LLC All Rights Reserved.
     *
     * Use of this source code is governed by an MIT-style license that can be
     * found in the LICENSE file at https://angular.io/license
     */var a=function(){function e(){}return e.prototype.get=function(e){return new Promise(function(t,n){r.readFile(e,function(e,r){if(e)return n(e);t(r.toString())})})},e}(),u=function(){function e(e,r){void 0===r&&(r=[]),this.moduleOrFactory=e,this.providers=r,this.factoryCacheMap=new Map,this.templateCache={}}return e.prototype.getCompiler=function(){return i.platformDynamicServer().injector.get(o.CompilerFactory).createCompiler([{providers:[{provide:n.ResourceLoader,useClass:a,deps:[]}]}])},e.prototype.render=function(e){return t.__awaiter(this,void 0,void 0,function(){var r,n,o;return t.__generator(this,function(a){switch(a.label){case 0:return(r=e.document)?[3,2]:[4,this.getDocument(e.documentFilePath)];case 1:r=a.sent(),a.label=2;case 2:return n=t.__spread(e.providers||[],this.providers||[],[{provide:i.INITIAL_CONFIG,useValue:{document:r,url:e.url}}]),[4,this.getFactory()];case 3:return o=a.sent(),[2,i.renderModuleFactory(o,{extraProviders:n})]}})})},e.prototype.getFactory=function(){var e=this,r=this.moduleOrFactory;if(r instanceof o.NgModuleFactory)return Promise.resolve(r);var t=this.factoryCacheMap.get(r);return t?Promise.resolve(t):this.getCompiler().compileModuleAsync(r).then(function(t){return e.factoryCacheMap.set(r,t),t})},e.prototype.getDocument=function(e){var t=this.templateCache[e]=this.templateCache[e]||r.readFileSync(e).toString();return Promise.resolve(t)},e}();
/**
     * @license
     * Copyright Google LLC All Rights Reserved.
     *
     * Use of this source code is governed by an MIT-style license that can be
     * found in the LICENSE file at https://angular.io/license
     */
/**
     * @license
     * Copyright Google LLC All Rights Reserved.
     *
     * Use of this source code is governed by an MIT-style license that can be
     * found in the LICENSE file at https://angular.io/license
     */
/**
     * @license
     * Copyright Google LLC All Rights Reserved.
     *
     * Use of this source code is governed by an MIT-style license that can be
     * found in the LICENSE file at https://angular.io/license
     */
e.ɵFileLoader=a,e.ɵCommonEngine=u,Object.defineProperty(e,"__esModule",{value:!0})});