/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
 */
import { forwardRef, Component, Input, ViewEncapsulation, ChangeDetectionStrategy } from '@angular/core';
import { NG_VALUE_ACCESSOR } from '@angular/forms';
/** @type {?} */
var starIcons = {
    outline: 'outline',
    full: 'full',
    half: 'half'
};
var NgxInputStarRatingComponent = /** @class */ (function () {
    function NgxInputStarRatingComponent() {
        this._value = 0;
        this.count = 5;
        this.disabled = false;
        this.starIcons = starIcons;
        this.buttons = [];
        // tslint:disable-next-line:no-empty
        this.onChange = function (_value) { };
        // tslint:disable-next-line:no-empty
        this.onTouched = function () { };
    }
    Object.defineProperty(NgxInputStarRatingComponent.prototype, "value", {
        get: /**
         * @return {?}
         */
        function () {
            return this._value;
        },
        set: /**
         * @param {?} val
         * @return {?}
         */
        function (val) {
            this._value = val;
            this.onChange(val);
            this.valueUpdate(this._value);
            this.onTouched();
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @param {?} fn
     * @return {?}
     */
    NgxInputStarRatingComponent.prototype.registerOnChange = /**
     * @param {?} fn
     * @return {?}
     */
    function (fn) {
        this.onChange = fn;
    };
    /**
     * @param {?} fn
     * @return {?}
     */
    NgxInputStarRatingComponent.prototype.registerOnTouched = /**
     * @param {?} fn
     * @return {?}
     */
    function (fn) {
        this.onTouched = fn;
    };
    /**
     * @param {?} value
     * @return {?}
     */
    NgxInputStarRatingComponent.prototype.writeValue = /**
     * @param {?} value
     * @return {?}
     */
    function (value) {
        if (value !== this.value) {
            this.value = value;
        }
    };
    /**
     * @return {?}
     */
    NgxInputStarRatingComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        for (var i = 0; i < this.count; i++) {
            this.buttons.push({ active: false, icon: starIcons.outline });
        }
        this.valueUpdate(this.value);
    };
    /**
     * @param {?} changes
     * @return {?}
     */
    NgxInputStarRatingComponent.prototype.ngOnChanges = /**
     * @param {?} changes
     * @return {?}
     */
    function (changes) {
        if (changes["value"] && changes["value"].currentValue) {
            this.valueUpdate(changes["value"].currentValue);
        }
    };
    /**
     * @param {?} index
     * @return {?}
     */
    NgxInputStarRatingComponent.prototype.rate = /**
     * @param {?} index
     * @return {?}
     */
    function (index) {
        this.buttons.forEach(function (btn, i) {
            if (i <= index) {
                btn.icon = starIcons.full;
            }
            else {
                btn.icon = starIcons.outline;
            }
        });
        /** @type {?} */
        var total = this.buttons.reduce(function (prev, next) {
            if (next.icon === starIcons.full) {
                return prev + 1;
            }
            else {
                return prev;
            }
        }, 0);
        this.value = total;
    };
    /**
     * @param {?} index
     * @return {?}
     */
    NgxInputStarRatingComponent.prototype.mouseEnter = /**
     * @param {?} index
     * @return {?}
     */
    function (index) {
        this.buttons.forEach(function (btn, i) {
            if (i <= index) {
                btn.active = true;
            }
            else {
                btn.active = false;
            }
        });
    };
    /**
     * @return {?}
     */
    NgxInputStarRatingComponent.prototype.mouseLeave = /**
     * @return {?}
     */
    function () {
        this.buttons.forEach(function (i) { return (i.active = false); });
    };
    /**
     * @param {?} value
     * @return {?}
     */
    NgxInputStarRatingComponent.prototype.valueUpdate = /**
     * @param {?} value
     * @return {?}
     */
    function (value) {
        this.buttons.forEach(function (btn, i) {
            /** @type {?} */
            var starValue = i + 1;
            if (value >= starValue) {
                btn.icon = starIcons.full;
            }
            if (value >= starValue - 0.5 && value < starValue) {
                btn.icon = starIcons.half;
            }
        });
    };
    NgxInputStarRatingComponent.decorators = [
        { type: Component, args: [{
                    selector: 'ngx-input-star-rating',
                    template: "<div class=\"ngx-input-rating\" (mouseleave)=\"mouseLeave()\">\n  <button type=\"button\" [disabled]=\"disabled\" *ngFor=\"let btn of buttons; let i = index\" class=\"ngx-input-rating__btn\" (click)=\"rate(i)\" [attr.aria-label]=\"'rate ' + (i + 1) + ' of ' + buttons.length\"\n    (mouseenter)=\"mouseEnter(i)\" class=\"ngx-input-star-rating__btn\">\n    <span *ngIf=\"btn.active || btn.icon === starIcons.full\" class=\"ngx-input-star-rating__full\">\n      <ng-container *ngTemplateOutlet=\"star\"></ng-container>\n    </span>\n    <ng-container *ngIf=\"!btn.active\">\n      <span *ngIf=\"btn.icon === starIcons.half\" class=\"ngx-input-star-rating__half\">\n        <ng-container *ngTemplateOutlet=\"star\"></ng-container>\n        <svg height=\"25\" width=\"10\" class=\"ngx-input-star-rating__star-half\">\n          <polygon points=\"9.9, 1.1, 3.3, 21.78, 19.8, 8.58, 0, 8.58, 16.5, 21.78\" style=\"fill-rule:nonzero;\"/>\n        </svg>\n      </span>\n      <span *ngIf=\"btn.icon !== starIcons.full && btn.icon !== starIcons.half\" class=\"empty\">\n        <ng-container *ngTemplateOutlet=\"star\"></ng-container>\n      </span>\n    </ng-container>\n  </button>\n</div>\n\n<ng-template #star>\n  <svg height=\"25\" width=\"23\" class=\"ngx-input-star-rating__star\">\n    <polygon points=\"9.9, 1.1, 3.3, 21.78, 19.8, 8.58, 0, 8.58, 16.5, 21.78\" style=\"fill-rule:nonzero;\"/>\n  </svg>\n</ng-template>",
                    changeDetection: ChangeDetectionStrategy.OnPush,
                    providers: [
                        {
                            provide: NG_VALUE_ACCESSOR,
                            useExisting: forwardRef(function () { return NgxInputStarRatingComponent; }),
                            multi: true
                        }
                    ],
                    encapsulation: ViewEncapsulation.None,
                    styles: ["*,::after,::before{box-sizing:border-box}ngx-input-star-rating{display:inline-block;--color-star-default:#ccc;--color-star-highlight:#3d3d3d}.ngx-input-star-rating__star{fill:#ccc;fill:var(--color-star-default)}.ngx-input-star-rating__btn{background-color:transparent;border:0;cursor:pointer;position:relative;width:30px;height:25px}.ngx-input-star-rating__btn svg{position:absolute;top:0;left:5px}.ngx-input-star-rating__full .ngx-input-star-rating__star,.ngx-input-star-rating__half .ngx-input-star-rating__star-half{fill:#3d3d3d;fill:var(--color-star-highlight)}"]
                }] }
    ];
    NgxInputStarRatingComponent.propDecorators = {
        _value: [{ type: Input, args: ['value',] }],
        count: [{ type: Input }],
        disabled: [{ type: Input }]
    };
    return NgxInputStarRatingComponent;
}());
export { NgxInputStarRatingComponent };
if (false) {
    /** @type {?} */
    NgxInputStarRatingComponent.prototype._value;
    /** @type {?} */
    NgxInputStarRatingComponent.prototype.count;
    /** @type {?} */
    NgxInputStarRatingComponent.prototype.disabled;
    /** @type {?} */
    NgxInputStarRatingComponent.prototype.starIcons;
    /** @type {?} */
    NgxInputStarRatingComponent.prototype.buttons;
    /** @type {?} */
    NgxInputStarRatingComponent.prototype.onChange;
    /** @type {?} */
    NgxInputStarRatingComponent.prototype.onTouched;
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmd4LWlucHV0LXN0YXItcmF0aW5nLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BuZ3gtbGl0ZS9pbnB1dC1zdGFyLXJhdGluZy8iLCJzb3VyY2VzIjpbIm5neC1pbnB1dC1zdGFyLXJhdGluZy5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztBQUFBLE9BQU8sRUFDTCxVQUFVLEVBQ1YsU0FBUyxFQUNULEtBQUssRUFJTCxpQkFBaUIsRUFDakIsdUJBQXVCLEVBQ3hCLE1BQU0sZUFBZSxDQUFDO0FBQ3ZCLE9BQU8sRUFBd0IsaUJBQWlCLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQzs7QUFFekUsSUFBTSxTQUFTLEdBQUc7SUFDaEIsT0FBTyxFQUFFLFNBQVM7SUFDbEIsSUFBSSxFQUFFLE1BQU07SUFDWixJQUFJLEVBQUUsTUFBTTtDQUNiLENBQUM7OztRQTZCQSxjQUF5QixDQUFDLENBQUM7UUFDM0IsYUFBaUIsQ0FBQyxDQUFDO1FBQ25CLGdCQUFvQixLQUFLLENBQUM7UUFFMUIsaUJBQXFCLFNBQVMsQ0FBQztRQUUvQixlQUErQyxFQUFFLENBQUM7O1FBR2xELGdCQUFXLFVBQUMsTUFBYyxLQUFPLENBQUM7O1FBR2xDLGlCQUFZLGVBQVEsQ0FBQzs7SUF2QnJCLHNCQUFJLDhDQUFLOzs7O1FBQVQ7WUFDRSxPQUFPLElBQUksQ0FBQyxNQUFNLENBQUM7U0FDcEI7Ozs7O1FBRUQsVUFBVSxHQUFHO1lBQ1gsSUFBSSxDQUFDLE1BQU0sR0FBRyxHQUFHLENBQUM7WUFDbEIsSUFBSSxDQUFDLFFBQVEsQ0FBQyxHQUFHLENBQUMsQ0FBQztZQUNuQixJQUFJLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQztZQUM5QixJQUFJLENBQUMsU0FBUyxFQUFFLENBQUM7U0FDbEI7OztPQVBBOzs7OztJQXVCRCxzREFBZ0I7Ozs7SUFBaEIsVUFBaUIsRUFBMkI7UUFDMUMsSUFBSSxDQUFDLFFBQVEsR0FBRyxFQUFF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O2FBQzNCO1NBQ0YsQ0FBQyxDQUFDOzs7Z0JBbEhOLFNBQVMsU0FBQztvQkFDVCxRQUFRLEVBQUUsdUJBQXVCO29CQUNqQyxvNUNBQXFEO29CQUVyRCxlQUFlLEVBQUUsdUJBQXVCLENBQUMsTUFBTTtvQkFDL0MsU0FBUyxFQUFFO3dCQUNUOzRCQUNFLE9BQU8sRUFBRSxpQkFBaUI7NEJBQzFCLFdBQVcsRUFBRSxVQUFVLENBQUMsY0FBTSxPQUFBLDJCQUEyQixFQUEzQixDQUEyQixDQUFDOzRCQUMxRCxLQUFLLEVBQUUsSUFBSTt5QkFDWjtxQkFDRjtvQkFDRCxhQUFhLEVBQUUsaUJBQWlCLENBQUMsSUFBSTs7aUJBQ3RDOzs7eUJBY0UsS0FBSyxTQUFDLE9BQU87d0JBQ2IsS0FBSzsyQkFDTCxLQUFLOztzQ0EvQ1I7O1NBZ0NhLDJCQUEyQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIGZvcndhcmRSZWYsXG4gIENvbXBvbmVudCxcbiAgSW5wdXQsXG4gIE9uQ2hhbmdlcyxcbiAgT25Jbml0LFxuICBTaW1wbGVDaGFuZ2VzLFxuICBWaWV3RW5jYXBzdWxhdGlvbixcbiAgQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3lcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBDb250cm9sVmFsdWVBY2Nlc3NvciwgTkdfVkFMVUVfQUNDRVNTT1IgfSBmcm9tICdAYW5ndWxhci9mb3Jtcyc7XG5cbmNvbnN0IHN0YXJJY29ucyA9IHtcbiAgb3V0bGluZTogJ291dGxpbmUnLFxuICBmdWxsOiAnZnVsbCcsXG4gIGhhbGY6ICdoYWxmJ1xufTtcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnbmd4LWlucHV0LXN0YXItcmF0aW5nJyxcbiAgdGVtcGxhdGVVcmw6ICcuL25neC1pbnB1dC1zdGFyLXJhdGluZy5jb21wb25lbnQuaHRtbCcsXG4gIHN0eWxlVXJsczogWycuL25neC1pbnB1dC1zdGFyLXJhdGluZy5jb21wb25lbnQuc2NzcyddLFxuICBjaGFuZ2VEZXRlY3Rpb246IENoYW5nZURldGVjdGlvblN0cmF0ZWd5Lk9uUHVzaCxcbiAgcHJvdmlkZXJzOiBbXG4gICAge1xuICAgICAgcHJvdmlkZTogTkdfVkFMVUVfQUNDRVNTT1IsXG4gICAgICB1c2VFeGlzdGluZzogZm9yd2FyZFJlZigoKSA9PiBOZ3hJbnB1dFN0YXJSYXRpbmdDb21wb25lbnQpLFxuICAgICAgbXVsdGk6IHRydWVcbiAgICB9XG4gIF0sXG4gIGVuY2Fwc3VsYXRpb246IFZpZXdFbmNhcHN1bGF0aW9uLk5vbmVcbn0pXG5leHBvcnQgY2xhc3MgTmd4SW5wdXRTdGFyUmF0aW5nQ29tcG9uZW50XG4gIGltcGxlbWVudHMgQ29udHJvbFZhbHVlQWNjZXNzb3IsIE9uSW5pdCwgT25DaGFuZ2VzIHtcbiAgZ2V0IHZhbHVlKCkge1xuICAgIHJldHVybiB0aGlzLl92YWx1ZTtcbiAgfVxuXG4gIHNldCB2YWx1ZSh2YWwpIHtcbiAgICB0aGlzLl92YWx1ZSA9IHZhbDtcbiAgICB0aGlzLm9uQ2hhbmdlKHZhbCk7XG4gICAgdGhpcy52YWx1ZVVwZGF0ZSh0aGlzLl92YWx1ZSk7XG4gICAgdGhpcy5vblRvdWNoZWQoKTtcbiAgfVxuXG4gIEBJbnB1dCgndmFsdWUnKSBfdmFsdWUgPSAwO1xuICBASW5wdXQoKSBjb3VudCA9IDU7XG4gIEBJbnB1dCgpIGRpc2FibGVkID0gZmFsc2U7XG5cbiAgcmVhZG9ubHkgc3Rhckljb25zID0gc3Rhckljb25zO1xuXG4gIGJ1dHRvbnM6IHsgYWN0aXZlOiBib29sZWFuOyBpY29uOiBzdHJpbmcgfVtdID0gW107XG5cbiAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm5vLWVtcHR5XG4gIG9uQ2hhbmdlID0gKF92YWx1ZTogbnVtYmVyKSA9PiB7fTtcblxuICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bm8tZW1wdHlcbiAgb25Ub3VjaGVkID0gKCkgPT4ge307XG5cbiAgcmVnaXN0ZXJPbkNoYW5nZShmbjogKHZhbHVlOiBudW1iZXIpID0+IHZvaWQpIHtcbiAgICB0aGlzLm9uQ2hhbmdlID0gZm47XG4gIH1cblxuICByZWdpc3Rlck9uVG91Y2hlZChmbjogKCkgPT4gdm9pZCkge1xuICAgIHRoaXMub25Ub3VjaGVkID0gZm47XG4gIH1cblxuICB3cml0ZVZhbHVlKHZhbHVlOiBudW1iZXIpIHtcbiAgICBpZiAodmFsdWUgIT09IHRoaXMudmFsdWUpIHtcbiAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgICB9XG4gIH1cblxuICBuZ09uSW5pdCgpIHtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuY291bnQ7IGkrKykge1xuICAgICAgdGhpcy5idXR0b25zLnB1c2goeyBhY3RpdmU6IGZhbHNlLCBpY29uOiBzdGFySWNvbnMub3V0bGluZSB9KTtcbiAgICB9XG5cbiAgICB0aGlzLnZhbHVlVXBkYXRlKHRoaXMudmFsdWUpO1xuICB9XG5cbiAgbmdPbkNoYW5nZXMoY2hhbmdlczogU2ltcGxlQ2hhbmdlcykge1xuICAgIGlmIChjaGFuZ2VzLnZhbHVlICYmIGNoYW5nZXMudmFsdWUuY3VycmVudFZhbHVlKSB7XG4gICAgICB0aGlzLnZhbHVlVXBkYXRlKGNoYW5nZXMudmFsdWUuY3VycmVudFZhbHVlKTtcbiAgICB9XG4gIH1cblxuICByYXRlKGluZGV4OiBudW1iZXIpIHtcbiAgICB0aGlzLmJ1dHRvbnMuZm9yRWFjaCgoYnRuLCBpKSA9PiB7XG4gICAgICBpZiAoaSA8PSBpbmRleCkge1xuICAgICAgICBidG4uaWNvbiA9IHN0YXJJY29ucy5mdWxsO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYnRuLmljb24gPSBzdGFySWNvbnMub3V0bGluZTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGNvbnN0IHRvdGFsID0gdGhpcy5idXR0b25zLnJlZHVjZSgocHJldiwgbmV4dCkgPT4ge1xuICAgICAgaWYgKG5leHQuaWNvbiA9PT0gc3Rhckljb25zLmZ1bGwpIHtcbiAgICAgICAgcmV0dXJuIHByZXYgKyAxO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIHByZXY7XG4gICAgICB9XG4gICAgfSwgMCk7XG5cbiAgICB0aGlzLnZhbHVlID0gdG90YWw7XG4gIH1cblxuICBtb3VzZUVudGVyKGluZGV4OiBudW1iZXIpIHtcbiAgICB0aGlzLmJ1dHRvbnMuZm9yRWFjaCgoYnRuLCBpKSA9PiB7XG4gICAgICBpZiAoaSA8PSBpbmRleCkge1xuICAgICAgICBidG4uYWN0aXZlID0gdHJ1ZTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGJ0bi5hY3RpdmUgPSBmYWxzZTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIG1vdXNlTGVhdmUoKSB7XG4gICAgdGhpcy5idXR0b25zLmZvckVhY2goaSA9PiAoaS5hY3RpdmUgPSBmYWxzZSkpO1xuICB9XG5cbiAgcHJpdmF0ZSB2YWx1ZVVwZGF0ZSh2YWx1ZTogbnVtYmVyKSB7XG4gICAgdGhpcy5idXR0b25zLmZvckVhY2goKGJ0biwgaSkgPT4ge1xuICAgICAgY29uc3Qgc3RhclZhbHVlID0gaSArIDE7XG5cbiAgICAgIGlmICh2YWx1ZSA+PSBzdGFyVmFsdWUpIHtcbiAgICAgICAgYnRuLmljb24gPSBzdGFySWNvbnMuZnVsbDtcbiAgICAgIH1cblxuICAgICAgaWYgKHZhbHVlID49IHN0YXJWYWx1ZSAtIDAuNSAmJiB2YWx1ZSA8IHN0YXJWYWx1ZSkge1xuICAgICAgICBidG4uaWNvbiA9IHN0YXJJY29ucy5oYWxmO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59XG4iXX0=